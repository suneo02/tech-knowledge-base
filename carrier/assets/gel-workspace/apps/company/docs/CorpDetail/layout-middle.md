# 企业详情页核心业务设计

## 概述

核心业务组件负责企业数据展示，包括菜单导航、企业信息展示、数据模块管理和滚动同步，是企业详情页的业务逻辑中心。

**功能边界**：菜单导航、数据展示、滚动同步、模块管理
**关键场景**：菜单构建与导航、滚动同步、数据模块渲染、权限控制

## 页面结构

| 区域         | 内容         | 交互                      | 可见条件         |
| ------------ | ------------ | ------------------------- | ---------------- |
| **企业介绍** | 基本信息卡片 | 查看详情、收藏、导出      | 完整页面模式     |
| **左侧菜单** | 树形导航     | 搜索、点击导航、展开/折叠 | 非单模块模式     |
| **基本信息** | 企业工商信息 | 查看详细数据              | 完整页面模式     |
| **数据模块** | 企业数据表格 | 筛选、分页、排序          | 根据企业类型显示 |

## 核心数据

| 字段           | 来源         | 用途               | 刷新策略     |
| -------------- | ------------ | ------------------ | ------------ |
| `basicNum`     | 企业统计API  | 菜单构建、模块显示 | 数据变化时   |
| `corpCategory` | 企业类型识别 | 菜单配置           | 企业类型变更 |
| `selectedKeys` | 菜单状态     | 当前选中菜单       | 滚动/点击时  |
| `expandedKeys` | 菜单状态     | 展开的菜单节点     | 用户操作时   |

## 组件结构

```
CompanyDetail
├── CorpDetailMenu (左侧菜单)
├── CompanyIntroduction (企业介绍)
├── CompanyBase (数据模块)
└── CompanyInfo (企业信息)
```

### 组件职责

- **CompanyDetail**：菜单导航、数据展示、滚动同步
- **CorpDetailMenu**：树形菜单、搜索、状态管理
- **CompanyBase**：模块渲染引擎、权限控制
- **CompanyIntroduction**：企业基本信息卡片

## 内容配置

### 模块配置分类

| 模块类型     | 配置文件             | 特性                 | 适用企业   |
| ------------ | -------------------- | -------------------- | ---------- |
| **基础信息** | `base.tsx`           | 企业工商、股东、人员 | 所有企业   |
| **IPO业务**  | `IpoBusinessData`    | 多标签页、图表集成   | IPO企业    |
| **公募基金** | `PublishFundData`    | 基金规模、旗下基金   | 公募基金   |
| **私募基金** | `PrivateFundData`    | 基金基本信息         | 私募基金   |
| **财务数据** | `finance.tsx`        | 财务报表、指标分析   | 一般企业   |
| **业务信息** | `buss.tsx`           | 经营状况、业务数据   | 一般企业   |
| **资质荣誉** | `qualifications.tsx` | 各类资质证书         | 所有企业   |
| **知识产权** | `ip.tsx`             | 专利、商标、软著     | 科技型企业 |
| **司法风险** | `risk.tsx`           | 诉讼、执行等司法信息 | 所有企业   |
| **经营风险** | `bussRisk.tsx`       | 行政处罚、经营异常   | 所有企业   |
| **历史数据** | `history.tsx`        | 历史变更记录         | 所有企业   |

### 模块显示控制

- **普通企业**：标准模块配置，通用菜单结构
- **私募基金**：私募专用模块，特殊菜单配置
- **公募基金**：公募专用模块，专业菜单结构
- **特殊企业**：根据菜单配置精确控制模块显示
- **数据过滤**：移除无数据模块，优化用户体验

## 菜单与模块联动

### 联动策略

企业数据加载 → 菜单构建 → 企业类型判断 → 显示对应模块 → 菜单与内容同步

### 控制规则

| 控制维度     | 普通企业     | 特殊企业   | 基金企业   |
| ------------ | ------------ | ---------- | ---------- |
| **菜单构建** | 标准配置     | 精简配置   | 专用配置   |
| **模块渲染** | 全部显示     | 菜单控制   | 分类显示   |
| **数据过滤** | 按数据可用性 | 按菜单配置 | 按业务类型 |

### 联动效果

- **菜单驱动**：左侧菜单决定中间区域显示内容
- **精确过滤**：特殊企业只显示配置的模块
- **用户体验**：界面内容与菜单导航保持一致

## 错误处理

| 错误类型         | 处理方式               | 用户提示       |
| ---------------- | ---------------------- | -------------- |
| **数据加载失败** | 显示错误状态，提供重试 | "数据加载失败" |
| **权限不足**     | 显示VIP提示            | "需要VIP权限"  |
| **网络异常**     | 显示网络错误           | "网络连接异常" |
| **数据格式错误** | 显示格式错误           | "数据格式异常" |

## 相关文档

- [总体设计](./design.md)
- [主容器布局](./layout-container.md)
- [左侧区域设计](./layout-left.md)
- [配置设计](./layout-config.md)
- [懒加载设计](./lazyLoad.md)
