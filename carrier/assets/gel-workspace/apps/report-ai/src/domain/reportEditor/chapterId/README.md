# chapterId

ç« èŠ‚ ID ç®¡ç†æ¨¡å—ï¼ˆè§†å›¾å±‚ï¼‰ï¼Œæä¾› TinyMCE ç¼–è¾‘å™¨ä¸­çš„ Section ID åŒæ­¥å’Œæ‰¹é‡æ˜ å°„

## ç›®å½•ç»“æ„

```
chapterId/
â”œâ”€â”€ index.ts      # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ ensureIds.ts  # ç¡®ä¿ç« èŠ‚ ID å­˜åœ¨
â””â”€â”€ applyIdMap.ts # åº”ç”¨ ID æ˜ å°„ï¼ˆä¸´æ—¶ ID â†’ æŒä¹…åŒ– IDï¼‰
```

## å…³é”®è¯´æ˜

- **ensureIds**: ç¡®ä¿ç¼–è¾‘å™¨ä¸­çš„ç« èŠ‚æ ‡é¢˜æœ‰å”¯ä¸€ IDï¼Œæ”¯æŒè‡ªåŠ¨åˆ†é…ä¸´æ—¶ ID å’Œä»çˆ¶å®¹å™¨ç»§æ‰¿ ID
- **applyIdMap**: åº”ç”¨ ID æ˜ å°„ï¼Œå°†ä¸´æ—¶ ID æ›¿æ¢ä¸ºæŒä¹…åŒ– IDï¼ˆè§†å›¾å±‚æ“ä½œï¼‰

## åä½œæ¨¡å—

æœ¬æ¨¡å—ä¸ `chapter/idMapping` åä½œï¼Œå…±åŒå®Œæˆ ID æ˜ å°„ï¼š

| æ¨¡å—                           | èŒè´£           | æ“ä½œå¯¹è±¡         | å‰¯ä½œç”¨         |
| ------------------------------ | -------------- | ---------------- | -------------- |
| **chapter/idMapping**          | æ•°æ®å±‚ ID æ˜ å°„ | ç« èŠ‚æ ‘æ•°æ®ç»“æ„   | æ— ï¼ˆçº¯å‡½æ•°ï¼‰   |
| **reportEditor/chapterId/ops** | è§†å›¾å±‚ ID æ˜ å°„ | TinyMCE DOM å…ƒç´  | æœ‰ï¼ˆä¿®æ”¹ DOMï¼‰ |

### å…¸å‹ä½¿ç”¨æµç¨‹

```typescript
// ä¿å­˜æˆåŠŸåï¼Œåç«¯è¿”å› ID æ˜ å°„
const idMap = { 'new-chapter-123': 'chapter-uuid-abc' };

// 1. æ›´æ–°æ•°æ®å±‚ï¼ˆç« èŠ‚æ ‘ï¼‰
const updatedChapters = applyIdMapToChapters(chapters, idMap);

// 2. æ›´æ–°è§†å›¾å±‚ï¼ˆç¼–è¾‘å™¨ DOMï¼‰
applySectionIdMap(editor, idMap);
```

## ä¾èµ–å…³ç³»

```
ops â†’ foundation
ops â‡„ chapter/idMapping (åä½œå…³ç³»ï¼Œä½¿ç”¨ç›¸åŒçš„ idMap æ ¼å¼)
```

---

> ğŸ“– æœ¬æ–‡æ¡£éµå¾ª [README ç¼–å†™è§„èŒƒ](../../../../../docs/rule/readme-rule.md)
