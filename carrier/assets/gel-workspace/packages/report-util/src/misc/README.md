# misc - é€šç”¨å·¥å…·é›†æ¨¡å—

## ğŸ¯ ä¸€å¥è¯å®šä½

æä¾›**å®‰å…¨å¤„ç†ã€æ•°ç»„æ“ä½œã€å›½é™…åŒ–è¾…åŠ©**ç­‰é€šç”¨å·¥å…·ï¼Œæ˜¯æŠ¥å‘Šç³»ç»Ÿçš„**åŸºç¡€å·¥å…·ç®±**ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
src/misc/
â”œâ”€â”€ api.ts                    # APIç›¸å…³å·¥å…·
â”œâ”€â”€ array.ts                  # æ•°ç»„æ“ä½œå·¥å…·
â”œâ”€â”€ basicNum.ts               # åŸºç¡€æ•°å€¼å¤„ç†
â”œâ”€â”€ corp.ts                   # ä¼ä¸šä¿¡æ¯å¤„ç†
â”œâ”€â”€ env.ts                    # ç¯å¢ƒæ£€æµ‹
â”œâ”€â”€ imageBase.ts              # å›¾ç‰‡Base64å¤„ç†
â”œâ”€â”€ intl/                     # å›½é™…åŒ–å·¥å…·
â”‚   â”œâ”€â”€ misc.ts               # å›½é™…åŒ–è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ stringUtils.ts        # å­—ç¬¦ä¸²å¤„ç†
â”‚   â””â”€â”€ translate.ts          # ç¿»è¯‘å·¥å…·
â”œâ”€â”€ replaceScript.ts          # XSSé˜²æŠ¤ - å®‰å…¨å¤„ç†æ ¸å¿ƒ
â”œâ”€â”€ tag.ts                    # æ ‡ç­¾å¤„ç†
â”œâ”€â”€ user.ts                   # ç”¨æˆ·ä¿¡æ¯å¤„ç†
â””â”€â”€ index.ts                  # ç»Ÿä¸€å¯¼å‡º
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### å®‰å…¨å¤„ç†
| å‡½æ•° | ç”¨é€” | é‡è¦æ€§ |
| :--- | :--- | :--- |
| **`replaceScript`** | XSSé˜²æŠ¤ | â­â­â­â­â­ |
| ç§»é™¤æ‰€æœ‰ `<script>` æ ‡ç­¾å’Œå±é™©å±æ€§ | ç¡®ä¿PDFç”Ÿæˆå®‰å…¨ |

### æ•°ç»„ä¸æ•°å€¼å¤„ç†
| å‡½æ•° | ç”¨é€” | è¯´æ˜ |
| :--- | :--- | :--- |
| **`arrayUtils`** | æ•°ç»„æ“ä½œå·¥å…· | å»é‡ã€æ’åºã€æŸ¥æ‰¾ |
| **`basicNum`** | åŸºç¡€æ•°å€¼å¤„ç† | æ•°å€¼éªŒè¯ã€è½¬æ¢ |

### å›½é™…åŒ–æ”¯æŒ
| æ¨¡å— | åŠŸèƒ½ |
| :--- | :--- |
| **`intl/misc.ts`** | i18nè¾…åŠ©å‡½æ•° |
| **`intl/stringUtils`** | å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç† |
| **`intl/translate.ts`** | ç¿»è¯‘å·¥å…·å‡½æ•° |

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

```typescript
import { replaceScript, arrayUtils } from 'report-util/misc';

// XSSé˜²æŠ¤ - æ‰€æœ‰HTMLå†…å®¹å¿…é¡»ç»è¿‡æ­¤å¤„ç†
const unsafeHtml = '<p>å†…å®¹<script>alert("XSS")</script></p>';
const safeHtml = replaceScript(unsafeHtml);
// â†’ '<p>å†…å®¹</p>'

// æ•°ç»„å·¥å…·
const uniqueArray = arrayUtils.unique([1, 2, 2, 3, 1]);
// â†’ [1, 2, 3]

// å›½é™…åŒ–å¤„ç†
import { translate } from 'report-util/misc/intl';
const text = translate('key', 'é»˜è®¤æ–‡æœ¬');
```

## âš ï¸ å®‰å…¨è¦æ±‚

### XSSé˜²æŠ¤ï¼ˆæ ¸å¿ƒè¦æ±‚ï¼‰
- **å¼ºåˆ¶ä½¿ç”¨**: æ‰€æœ‰ç”¨æˆ·è¾“å…¥HTMLå¿…é¡»é€šè¿‡ `replaceScript` å¤„ç†
- **é˜²æŠ¤èŒƒå›´**: ç§»é™¤ `<script>`, `<iframe>`, `<form>`, `onclick` ç­‰å±é™©å…ƒç´ 
- **PDFå®‰å…¨**: ç¡®ä¿wkhtmltopdfç”Ÿæˆçš„PDFä¸è¢«æ¶æ„è„šæœ¬æ³¨å…¥

### ES5å…¼å®¹æ€§
- **æ— ç°ä»£API**: ç¦æ­¢ä½¿ç”¨ `includes`, `Promise`, `Array.prototype.values` ç­‰
- **åŸç”Ÿå®ç°**: æ‰€æœ‰åŠŸèƒ½ä½¿ç”¨åŸç”ŸES5è¯­æ³•å®ç°
- **æ— ä¾èµ–**: ä¸ä¾èµ–å¤–éƒ¨polyfillåº“

## ğŸ¯ åº”ç”¨åœºæ™¯

### æŠ¥å‘Šå®‰å…¨
- ç”¨æˆ·è¾“å…¥å†…å®¹æ¸…ç†
- å¯Œæ–‡æœ¬å®‰å…¨å¤„ç†
- HTMLæ ‡ç­¾è¿‡æ»¤

### æ•°æ®å¤„ç†
- ä¼ä¸šä¿¡æ¯éªŒè¯å’Œæ ¼å¼åŒ–
- ç”¨æˆ·ä¿¡æ¯å¤„ç†
- æ•°ç»„å’Œå¯¹è±¡æ“ä½œ

### å¤šè¯­è¨€æ”¯æŒ
- æ–‡æœ¬ç¿»è¯‘å’Œæœ¬åœ°åŒ–
- å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç†
- å›½é™…åŒ–æ ¼å¼è½¬æ¢

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [report-util ä¸»æ–‡æ¡£](../README.md)
- [tableæ¨¡å— - æ¸²æŸ“å™¨å®‰å…¨](../table/README.md)
- [XSSé˜²æŠ¤æœ€ä½³å®è·µ](https://owasp.org/www-community/xss-filtering-cheat-sheet)