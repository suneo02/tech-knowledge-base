# 企业详情页特殊节点配置说明

## 概述

本文档说明企业详情页中特殊业务节点的配置方式，包括股东穿透、实际控制人、股东变更、历史数据等复杂业务场景。这些节点通过`CompanyTable`组件消费配置，但具有特殊的业务逻辑和交互行为。

## 特殊节点类型

### 1. 股东穿透节点

**业务特点**：展示企业股权结构的逐层穿透信息，支持动态层级展示和交互筛选。

**配置要点**：
- 通过`eachTableKey='showSharePenetration'`识别
- 支持穿透类型切换（逐层展示/合并统计）
- 需要处理持股比例筛选和层级控制

**关键配置项**：

| 配置项 | 说明 | 类型 |
|--------|------|------|
| `enableNodeJump` | 启用节点跳转 | boolean |
| `mergeSameNameNodes` | 合并同名节点 | boolean |
| `penetrationType` | 穿透类型 | number |

### 2. 实际控制人节点

**业务特点**：展示企业最终控制人信息，支持多数据源整合和标签页展示。

**配置要点**：
- 通过`eachTableKey='showMainMemberInfo'`识别
- 支持多标签页（公告披露/计算识别）
- 需要整合不同数据源

**数据源配置**：

| 数据源 | 配置键 | 说明 |
|--------|--------|------|
| 公告披露 | `publishData` | 优先展示官方数据 |
| 计算识别 | `calcData` | AI算法计算结果 |
| 历史数据 | `historyData` | 变更记录对比 |

### 3. 股东变更节点

**业务特点**：展示股东变更历史，支持变更类型筛选和时间范围选择。

**配置要点**：
- 通过`eachTableKey='showCompanyChange'`识别
- 支持变更前后数据对比
- 需要处理时间维度的变更记录

**特殊配置**：
- `bordered: 'dotted'` - 虚线边框样式
- `aggName` - 数据聚合字段配置
- 嵌套的`children`列配置支持变更前后对比

### 4. 历史数据节点

**业务特点**：展示企业历史变更记录，支持时间轴展示和分类筛选。

**配置要点**：
- 通过`eachTableKey='historycompany'`识别
- 支持按变更类型筛选
- 需要处理时间序列数据

**筛选配置**：
- `rightFilters` - 右侧筛选器配置
- `selName` - 变更类型筛选参数
- `dataComment` - 数据来源标注

## 特殊节点消费机制

### 节点识别流程

1. **配置获取**：从`corpModuleCfg`获取特殊节点配置
2. **业务判断**：`CompanyBaseY`中进行特殊业务逻辑处理
3. **组件创建**：通过`makeTable`创建`CompanyTable`实例
4. **特殊处理**：`CompanyTable`内部识别节点类型并应用特殊逻辑

## 性能优化策略

### 数据加载优化

| 优化策略 | 说明 |
|----------|------|
| **分页加载** | 大数据量使用分页，每页默认10条 |
| **延迟加载** | 非活跃标签页数据延迟加载 |
| **缓存机制** | 相同参数结果在组件生命周期内缓存 |

### 渲染优化

| 优化策略 | 说明 |
|----------|------|
| **虚拟滚动** | 历史数据等长列表使用虚拟滚动 |
| **组件复用** | 相同类型特殊节点组件实例复用 |
| **条件渲染** | 根据权限和业务条件控制渲染 |

## 错误处理机制

### 业务异常处理

| 异常类型 | 处理方式 |
|----------|----------|
| **计算超时** | 显示部分结果 + 重试按钮 |
| **数据不完整** | 标识缺失数据 |
| **权限不足** | 显示VIP提示 |

## 相关文档

- [企业详情页内容区域节点配置规范](./node-config-usage.md)
- [CompanyTable组件说明](./company-table.md)
- [企业详情页整体设计](./layout-middle.md)