---
description: basic rule
globs: 
alwaysApply: false
---
# 开发规范与要求（Cursor Rules）

## 一、核心技术栈
你是一位精通 pnpm、TypeScript、Node.js、React、Webpack、WindUI 和 Less 的专家。在开发过程中，需遵循以下规则进行编码。
Wind UI 是基于Ant Design 4的一个UI 框架，你可以简单的理解为 and design

## 二、关键原则
1. **代码风格**
    - 编写简洁、技术性强的响应内容，提供准确的 TypeScript 示例。
    - 采用函数式、声明式编程，避免使用类，箭头函数优先。
    - 优先考虑迭代和模块化，减少代码重复。
    - 使用具有描述性的变量名，可搭配助动词（如 `isLoading`）。
    - 目录命名采用小写字母加连字符的形式（如 `components/auth - wizard`）。
    - 组件使用命名导出方式。
    - 遵循“接收对象，返回对象”（RORO）模式。
2. **JavaScript/TypeScript 规范**
    - 纯函数使用 const 关键字定义 = () => {} ，省略分号。
    - 所有代码使用 TypeScript 编写，优先使用接口而非类型。
    - 文件结构：按照导出组件、子组件、辅助函数、静态内容、类型的顺序组织。
    - 条件语句中避免使用不必要的花括号，单行语句的条件语句可省略花括号。
    - 简单条件语句采用简洁的单行语法（如 `if (condition) doSomething()`）。
3. **错误处理与边界情况**
    - 优先处理错误和边界情况，在函数开始处进行检查。
    - 对于错误条件，使用提前返回的方式，避免深层嵌套的 `if` 语句。
    - 函数中最后处理正常流程，以提高代码可读性。
    - 避免使用不必要的 `else` 语句，采用 `if - return` 模式。
    - 使用守卫子句提前处理前置条件和无效状态。
    - 实现正确的错误日志记录和用户友好的错误消息。
    - 考虑使用自定义错误类型或错误工厂进行一致的错误处理。
4. **代码注释**
    - 所有组件必须添加注释，注释内容包括：作者@author 张文浩<suneo@wind.com.cn> 、组件名、参数、功能描述。
    - 所有类型必须添加注释，注释内容包括：类型名，统一使用 // 来注释。
## 三、依赖管理
项目依赖于 Webpack 和 Ant Design 5，Less 需确保这些依赖的正确使用和版本管理。所有安装依赖必须使用npx pnpm install 安装， 所有关于module的node方法以.cjs为准

## 四、React 开发规范
1. **组件开发**
    - 涉及到用户权限使用 store/user
    - 使用函数式组件和 TypeScript 接口。
    - 使用声明式 JSX。
    - 组件定义使用 const 而非 function。
    - 使用 Ant Design 5 进行组件开发，遵循其组件设计和使用规范。
    - 采用 Less 进行样式设置，实现响应式设计，遵循移动优先的设计原则。
    - 将静态内容和接口定义放在文件末尾，在渲染函数外部使用内容变量存储静态内容。
    - 尽量减少 `useEffect` 和 `setState` 的使用，可结合上下文和状态管理库优化状态处理。
    - 使用 Zod 进行表单验证。
    - 使用 `Suspense` 包裹客户端组件，并提供 fallback。
    - 对非关键组件使用动态加载。
    - 优化图片，采用 WebP 格式，设置大小数据并使用懒加载。
    - 每生成一个组件，需要在views/components-demo/文件夹中生成一个对应的组件示例。
2. **错误处理**
    - 将预期错误建模为返回值，在函数中避免使用 `try/catch` 处理预期错误，可通过返回错误对象等方式处理。
    - 使用错误边界处理意外错误，提供 fallback UI。
    - 在表单验证中使用 `react - hook - form` 结合 Zod 进行验证，并处理错误信息。
    - 服务层代码应始终抛出用户友好的错误，方便在组件中捕获并展示给用户。
3. **状态管理**
    - 对于简单状态，可使用 React 的 `useState` 和 `useContext`。
    - 对于复杂状态管理，可考虑使用状态管理库如 Redux Toolkit 等。

## 五、新增组件或工具方法要求
### 1. 单元测试
每次添加新的组件（`components`）或工具方法（`utils`）时，必须使用 React Jest 编写相应的单元测试。单元测试应覆盖组件或工具方法的主要功能和边界情况，确保其正确性和稳定性。测试文件应放在与组件或工具方法对应的 `__tests__` 文件夹下，文件名遵循 `[组件或工具方法名].test.tsx` 或 `[组件或工具方法名].test.ts` 的命名规则。