# 标题嵌套假设问题

> 📖 本文档遵循 [Issue 文档编写规范](../../../../../docs/rule/issue-doc-rule.md)

## 问题概览

| 字段         | 内容                                                  |
| ------------ | ----------------------------------------------------- |
| 问题         | 章节解析假设 h 标签在最外层，嵌套结构可能导致解析失败 |
| 状态         | 🚧 进行中                                             |
| 优先级       | 🟡 P1                                                 |
| 责任人       | -                                                     |
| 发现时间     | 2025-10-23                                            |
| 预期解决时间 | 待定                                                  |

## 文档索引

| 文档                               | 阶段     | 状态 | 说明                     |
| ---------------------------------- | -------- | ---- | ------------------------ |
| [问题分析](./issue-analysis.md)    | 问题分析 | ✅   | 现象、根因、影响、示例   |
| [解决方案](./solution-options.md)  | 方案设计 | ✅   | 4 种方案对比与推荐       |
| [验证计划](./verification-plan.md) | 验证测试 | 🚧   | 验证步骤、测试用例、监控 |

## 快速导航

- **核心问题**：`getContentNodesAfterHeading` 依赖平级结构，嵌套标题可能导致内容丢失
- **推荐方案**：HTML 结构规范化（方案 A）
- **待调研**：AI 生成内容结构、历史数据、TinyMCE 粘贴行为

## 待办事项

- [ ] 调研 AI 生成的 HTML 结构特征
- [ ] 检查现有报告数据是否存在嵌套标题
- [ ] 验证 TinyMCE 粘贴行为
- [ ] 检查测试用例覆盖度
- [ ] 评估各方案的工作量和风险
- [ ] 选择最终方案并实施
- [ ] 在 `chapterStructure.ts` 文件头部文档化平级结构假设
- [ ] 添加针对嵌套场景的单元测试
- [ ] 如需实施方案 A，实现 HTML 预处理逻辑
- [ ] 更新相关文档，明确结构要求

## 更新日志

| 日期       | 事件 | 描述                                               |
| ---------- | ---- | -------------------------------------------------- |
| 2025-10-29 | 重构 | 按照 Issue 规范拆分文档，创建索引与子文档          |
| 2025-10-23 | 创建 | 初始创建，识别标题嵌套假设问题，待调研确认影响范围 |

## 相关文档

- [Issue 文档编写规范](../../../../../docs/rule/issue-doc-rule.md)
- [文档编写规范](../../../../../docs/rule/documentation-rule.md)
- [TypeScript 编码规范](../../../../../docs/rule/typescript-rule.md)
- [错误处理规范](../../../../../docs/rule/error-handling-rule.md)
