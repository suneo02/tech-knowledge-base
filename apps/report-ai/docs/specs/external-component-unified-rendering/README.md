# 外部组件统一渲染机制 Spec

> 📖 本文档遵循 [Spec 文档编写规范](../../../../../docs/rule/spec-doc-rule.md)

## 任务概览

| 项目       | 内容                                                                        |
| ---------- | --------------------------------------------------------------------------- |
| 任务来源   | 报告编辑器外部组件渲染机制优化需求                                          |
| 负责人     | TBD                                                                         |
| 目标时间   | TBD                                                                         |
| 当前版本   | v1.0                                                                        |
| 当前状态   | 📝 规划中                                                                   |
| 关联文档   | [外部组件渲染设计](../../RPDetail/RPEditor/external-component-rendering.md) |
| 关联 Issue | TBD                                                                         |

## 文档索引

本任务拆分为以下子文档，按阶段递进：

| 文档                                                | 阶段         | 状态 | 说明                             |
| --------------------------------------------------- | ------------ | ---- | -------------------------------- |
| [spec-analysis-v1.md](./spec-analysis-v1.md)        | 现状分析     | ✅   | 现有实现评估与问题盘点           |
| [spec-implementation-plan-v1.md](./spec-implementation-plan-v1.md) | 实施计划 | ✅   | 统一渲染机制目标、拆解与验证方案 |

## 快速导航

- **核心问题**：现有外部组件（AIGC 按钮、加载占位、文本改写预览）的挂载、卸载、定位、滚动跟随等实现方式各不相同，存在大量重复逻辑
- **优化目标**：提取通用渲染机制，统一外部组件的生命周期管理、定位计算、容器管理
- **参考实现**：`useTextRewritePreview` 的模块化设计（hook + types + utils）是较好的实践
- **关键约束**：不影响现有功能，保持向后兼容，渐进式重构

## 更新记录

| 日期       | 修改人 | 更新内容                                                              |
| ---------- | ------ | --------------------------------------------------------------------- |
| 2025-11-04 | Kiro   | 创建 Spec 索引，完成现状分析与方案设计文档                            |
| 2025-11-04 | Codex  | 补充现状分析、拆分实施计划文档，调整索引结构并校对引用一致性 |

## 相关文档

- [Spec 文档编写规范](../../../../../docs/rule/spec-doc-rule.md)
- [外部组件渲染设计](../../RPDetail/RPEditor/external-component-rendering.md)
- [React 组件规范](../../../../../docs/rule/react-rule.md)
- [TypeScript 编码规范](../../../../../docs/rule/typescript-rule.md)
