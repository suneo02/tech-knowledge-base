# 单章节 AIGC 需求与背景

> 📖 回链：[任务概览](./README.md) | 阶段：需求分析

## 背景概览

| 维度     | 摘要 |
| -------- | ---- |
| 业务诉求 | 支持单章节内容的快速重新生成，避免全文流程的等待成本 |
| 现状能力 | 已有 [AIGC 核心流程](../../RPDetail/ContentManagement/aigc-core-flow.md) 与全文生成功能，具备校验、流式与注水基础 |
| 核心缺口 | 队列开销高、首条响应慢、状态耦合强，影响单章节体验 |

## 用户场景

| 场景 | 触发 | 关键动作 | 期望反馈 |
| ---- | ---- | -------- | -------- |
| S1 快速重写 | 章节内容不满意，点击“重新生成” | 清空章节 → 直连 AI → 流式预览 | 首条 <2s，生成 <30s，进度线性展示 |
| S2 失败重试 | AI 返回错误 | 显示错误提示 → 一次点击重试 | 状态复位，无需清理等待 |
| S3 中途取消 | 用户误触或临时调整 | 发起取消 → 回滚上一版内容 | 500ms 内恢复，章节解锁 |

## 核心需求

### 功能

| 编号 | 内容 | 验收要点 |
| ---- | ---- | -------- |
| F1 | 独立状态容器，隔离全文生成 | 同时触发时互不影响 |
| F2 | 直接触发 AI 请求，无队列 | 请求立即发出，状态置为 `generating` |
| F3 | 简洁进度展示与完成清理 | 流式更新 0-100%；完成后 1s 内清理 |
| F4 | 支持取消与重试 | 清理状态后可立即重新发起 |

### 性能

| 指标 | 目标 | 说明 |
| ---- | ---- | ---- |
| P1 | 首条消息 <2s | 95% 请求达标 |
| P2 | 完成耗时 <30s | 单章节流程 |
| P3 | 清理耗时 <500ms | 成功、失败、取消均需满足 |

## 约束

- 复用现有校验与流式实现，避免重复逻辑。
- 与编辑器注水机制兼容，章节锁一致。
- 保持与全文生成相同的错误提示与权限策略。

## 参考资料

- [单章节 AIGC 场景文档](../../RPDetail/ContentManagement/single-chapter-aigc-flow.md)
- [全文生成流程](../../RPDetail/ContentManagement/full-generation-flow.md)

## 更新记录

| 日期       | 修改人 | 更新内容                       |
| ---------- | ------ | -------------------------------- |
| 2025-10-30 | Kiro   | 精简场景与需求，移除冗余说明   |
| 2025-10-29 | Kiro   | 创建需求文档，定义用户场景和核心需求 |
