# MultiTable 组件设计文档

## 概述

MultiTable 是一个基于 VTable 的高性能表格组件，支持虚拟滚动和大数据量渲染。该组件封装了 VTable 的核心功能，提供了表格初始化、数据加载、操作记录等功能，适用于需要处理大量数据的表格场景。

## 详细功能说明

MultiTable 组件实现了以下核心功能：

1. **表格初始化**：通过 `useTableInitialization` 钩子初始化表格，包括获取表头信息、行数据等。
2. **虚拟滚动**：利用 VTable 的虚拟滚动技术，实现大数据量的高效渲染。
3. **数据懒加载**：通过批次加载数据的方式，优化大数据量表格的性能。
4. **操作记录**：支持记录表格操作，便于实现撤销/重做功能。
5. **引用暴露**：通过 `useImperativeHandle` 暴露内部的 tableInstance，便于父组件访问和控制表格实例。

组件内部使用了多个自定义钩子来分离关注点，提高代码的可维护性：

- `useTableInitialization`：负责表格的初始化和数据加载
- `useTableOperationHandlers`：处理表格操作相关的逻辑

## 参数说明

| 参数名                | 类型                                | 描述                               |
| --------------------- | ----------------------------------- | ---------------------------------- |
| id                    | string                              | 表格的唯一标识符，用于获取表格数据 |
| handleRecordOperation | (operation: TableOperation) => void | 记录表格操作的回调函数             |
| ref                   | React.Ref<TableContentRef>          | 引用对象，可用于访问表格实例       |

## 返回值说明

组件通过 ref 暴露以下内容：

| 属性名        | 类型             | 描述                                  |
| ------------- | ---------------- | ------------------------------------- |
| tableInstance | VTable.ListTable | VTable 的实例对象，可用于直接操作表格 |

## 使用示例

```tsx
import { useRef } from 'react'
import MultiTable, { TableContentRef } from '@/pages/Demo/component/MultiTable'
import { TableOperation } from '@/components/MultiTable/types/operations'
import { useTableOperationHandlers } from '@/pages/Demo/hooks'

const MyComponent = () => {
  const tableRef = useRef<TableContentRef>(null)

  const { handleRecordOperation } = useTableOperationHandlers({
    tableInstance: { current: tableRef.current?.tableInstance || null },
  })

  return (
    <div>
      <h1>我的表格</h1>
      <MultiTable ref={tableRef} id="table-001" handleRecordOperation={handleRecordOperation} />
    </div>
  )
}
```
