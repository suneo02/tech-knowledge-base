# Company 全球企业信息平台 | 2023.10 - 2024.06

**角色**：核心开发者（核心模块开发与性能优化）

**项目背景**：
面向专业分析师的全球企业信息查询平台，聚合企业基本面、财务、风险、知识产权等多维数据。项目面临海量数据渲染卡顿、复杂关系图谱交互迟滞、以及多模块异步加载的状态管理挑战。

**核心技术栈**：React 18 + TypeScript + Redux + Webpack 5 + Ant Design + Cytoscape.js

## 🏗️ 架构设计与实现

### 1. 响应式布局与模块化架构

- **布局系统**：设计 `LayoutHeader + Left + Right` 三栏响应式架构，通过 Flexbox 与 CSS Grid 实现自适应布局。
- **动态侧栏**：开发 AI 助手面板的动态折叠/展开机制（25%/50% 宽度切换），利用 CSS Transition 实现无损帧率的平滑过渡，并在小屏设备（<768px）自动切换为单栏模式。
- **模块化配置**：构建基于 JSON 配置的模块渲染引擎，支持 50+ 业务模块（工商、财务、风险等）的动态编排。
- **权限控制**：设计基于位掩码（Bitmask）的权限控制系统，精确控制不同用户等级（VIP/普通）对 20+ 种敏感数据字段的可见性。

### 2. 性能优化体系

- **长列表虚拟化**：引入 **@tanstack/react-virtual** 重构企业列表与聊天记录组件，实现动态高度计算与滚动位置保持，将 DOM 节点维持在视口可见范围内（~2000 个节点），彻底解决长列表内存暴涨问题。
- **智能懒加载**：
  - **视口检测**：基于 `IntersectionObserver` API 实现模块级懒加载，配合 300ms 防抖策略，避免快速滚动时的无效网络请求。
  - **预加载策略**：根据视口高度动态计算预加载阈值，提前加载可视区域下方 1-2 个模块，消除白屏等待感。
- **构建优化**：利用 React.lazy + Webpack Code Splitting 实现路由级与组件级代码分割，将首屏 JS Bundle 体积压缩 60% 以上。

## 🧩 核心功能开发

### 3. 企业关系图谱可视化

- **高性能渲染**：集成 **Cytoscape.js** 开发企业关联图谱（IPO 股东穿透、关联方识别），支持 1000+ 节点的复杂网络渲染。
- **交互优化**：实现 Canvas 层级的事件代理，支持平滑缩放、拖拽与节点高亮；通过增量布局算法优化大规模数据加载时的页面冻结问题。
- **图谱导出**：封装图谱导出功能，支持自定义水印与高分辨率 PNG/SVG 导出，解决 Canvas 跨域与清晰度问题。

### 4. AI 智能助手集成

- **流式对话组件**：开发 `ChatMessageCore` 核心组件，封装 SSE (Server-Sent Events) 连接逻辑，实现打字机式流式响应。
- **上下文管理**：设计 Redux 中间件管理多轮对话上下文，支持在对话中动态插入企业卡片、图表等富媒体内容。
- **交互体验**：实现消息列表的自动滚动锚定（Scroll Anchoring），确保新消息到达时用户视角不漂移。

### 5. 复杂数据交互

- **数据导出管道**：集成 `xlsx` 库并在 Web Worker 中运行数据处理逻辑，避免大数据量导出时阻塞主线程 UI。
- **多维筛选**：实现基于 URL 参数同步的筛选状态管理，支持 10+ 种维度的组合筛选与分享功能。

## 📊 技术成果

- **性能提升**：首屏内容渲染时间（FCP）显著降低，长列表滚动帧率稳定在 60fps。
- **体验优化**：通过虚拟化技术，内存占用在大数据量场景下降低 70%。
- **功能完备**：成功上线 IPO 股东核查、关联方图谱等高复杂度可视化功能。
