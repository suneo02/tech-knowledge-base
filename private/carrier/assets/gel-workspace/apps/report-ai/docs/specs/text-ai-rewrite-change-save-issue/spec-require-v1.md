# 问题分析 - 文本 AI 重写变更保存触发

## 问题描述

文本 AI 重写功能在用户确认应用改写结果后，编辑器未正确触发变更事件，导致自动保存失效。

## 具体表现

1. **变更事件未触发**：内容替换后 TinyMCE 的 `change` 事件未触发
2. **脏状态未更新**：编辑器 `hasDirty` 状态保持为 `false`
3. **自动保存失效**：用户修改的内容无法自动保存

## 根本原因

当前实现可能通过直接 DOM 操作替换内容，绕过了 TinyMCE 的事件系统。

## 修复需求

- 确保内容替换后触发 TinyMCE 的 `change` 事件
- 正确更新编辑器的脏状态
- 保持与其他编辑功能的一致性

## 相关文件

- `apps/report-ai/src/hooks/useTextRewrite.ts` - 主要修复位置
- [原始实现](../archived/text-ai-rewrite-implementation/spec-design-v1.md)

## 更新记录

| 日期       | 修改人 | 更新内容 |
| ---------- | ------ | -------- |
| 2025-11-04 | Codex  | 创建问题分析 |