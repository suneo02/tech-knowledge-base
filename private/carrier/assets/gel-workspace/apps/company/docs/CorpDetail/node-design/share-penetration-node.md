# 股东穿透节点设计

## 业务场景

股东穿透节点用于展示企业的股东结构，支持多层级穿透分析，帮助用户了解企业的实际控制关系和股权分布情况。

## 🎯 设计目标

### 1. 功能目标

- 多层穿透：支持5层股权穿透分析
- 比例筛选：按持股比例筛选股东
- 路径展示：显示完整的持股路径
- 类型切换：支持自然人/企业股东切换

### 2. 性能目标

- 响应时间：< 3秒（单次穿透计算）
- 并发处理：支持100+并发
- 数据准确性：99.9%

## 🔧 配置设计

### 基础配置

包含标题、API接口、列配置和请求参数等基础信息。

### 特殊配置

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `supportPenetrationType` | boolean | true | 支持穿透类型切换 |
| `supportRatioFilter` | boolean | true | 支持比例筛选 |
| `maxLevel` | number | 5 | 最大穿透层级 |
| `defaultRatio` | number | 0 | 默认比例阈值 |
| `ratioStep` | number | 5 | 比例筛选步长 |
| `supportExport` | boolean | false | 支持结果导出 |

### 交互配置

包含层级控制、比例滑块、类型切换、路径展开等交互元素的开关配置。

## 🎨 交互设计

### 1. 穿透类型切换

提供自然人股东、企业股东和全部股东的切换选项，默认显示全部股东，切换时即时刷新数据。

### 2. 比例筛选器

使用滑块控件筛选持股比例，范围0%-100%，步长5%，松开滑块后触发查询。

### 3. 层级控制

通过加减按钮或下拉选择控制穿透层级，范围1-5层，超过3层显示性能警告。

## 📊 数据结构设计

### 请求参数

包含企业代码、穿透层级、比例阈值、股东类型等参数。

### 响应数据结构

包含穿透节点列表、总数、计算时间和置信度等信息，每个节点包含名称、持股比例、类型、路径、层级等属性。

## ⚡ 性能优化策略

### 1. 计算优化

- 缓存机制：Redis缓存计算结果
- 异步处理：消息队列异步计算
- 增量更新：只计算变更部分

### 2. 数据优化

- 预计算：定期预计算常见企业
- 数据分片：按地区/行业分片存储
- 索引优化：建立专用索引

### 3. 前端优化

- 虚拟滚动：只渲染可视区域
- 懒加载：按需加载子节点
- 本地缓存：缓存查询结果

## 🛡️ 错误处理设计

### 1. 业务异常

- 计算超时：返回部分结果 + 重试提示
- 数据缺失：标识缺失节点
- 权限不足：显示VIP提示

### 2. 系统异常

- 网络异常：重试机制
- 服务异常：降级方案
- 数据异常：数据校验

## 🔍 数据质量设计

### 1. 置信度标识

- 高(>90%)：绿色标识，数据完整准确
- 中(70-90%)：黄色标识，数据基本准确
- 低(<70%)：红色标识，数据仅供参考
| **中(70%-90%)** | 黄色标识 | 部分数据缺失 |
| **低(<70%)** | 红色标识 | 数据不完整 |

### 2. 数据来源说明

```
股东名称: 张三
持股比例: 25%
数据来源: 工商信息 (2024-01-15)
```

### 3. 免责声明

> ⚠️ 注：穿透结果基于公开数据计算，仅供参考，不构成投资建议

## 📈 扩展设计

### 1. 功能扩展

| 扩展功能 | 配置项 | 说明 |
|----------|--------|------|
| **路径导出** | `supportPathExport` | 导出完整穿透路径 |
| **图谱展示** | `supportGraphView` | 图形化展示股权结构 |
| **对比分析** | `supportCompare` | 对比不同时间点的股权结构 |

### 2. 业务扩展

| 扩展场景 | 配置项 | 说明 |
|----------|--------|------|
| **历史穿透** | `supportHistoryPenetration` | 查看历史股权穿透 |
| **关联方识别** | `supportRelatedParties` | 识别关联方关系 |
| **受益所有人** | `supportBeneficialOwner` | 识别最终受益所有人 |

## 🔗 相关文档

- [节点设计规范](./node-design-spec.md) - 通用设计原则
- [配置消费机制](./config-consumption.md) - 配置使用方式
- [企业详情页内容区域节点配置规范](../node-config-usage.md) - 通用配置规范