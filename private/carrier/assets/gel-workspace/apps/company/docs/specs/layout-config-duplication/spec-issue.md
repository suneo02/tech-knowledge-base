# 问题分析：配置重复维护

> 所属任务：[企业详情页配置重复维护问题](./README.md)
> 文档版本：v1
> 创建日期：2024-11-07

## 背景与预期

企业详情页通过配置系统实现左侧菜单与中间内容的动态联动。预期应具备：单一数据源、配置一致性保证、易于维护扩展。

**参考文档**：
- @see `../../CorpDetail/layout-config.md`
- @see `../../CorpDetail/layout-left.md`
- @see `../../CorpDetail/layout-middle.md`

## 问题现象

### 1. 配置全量加载，资源浪费

中间内容配置（`listRowConfig`）在页面初始化时全量加载所有模块配置（11个），包括未使用的模块。

**代码位置**：
- @see `src/components/company/listRowConfig.tsx`
- @see `src/components/company/handle/index.ts`

**问题表现**：
普通企业可能只显示 5-6 个模块，但加载了 11 个模块的完整配置（含 React 组件、表格配置、图表配置）。海外企业、个体工商户等特殊类型企业加载了大量不会使用的配置。

### 2. 模块顺序重复维护

左侧菜单配置和中间内容配置各自维护了一次模块顺序。

**代码位置**：
- @see `src/views/Company/menu/menus.ts`
- @see `src/components/company/listRowConfig.tsx`

### 3. 统计数字重复维护

`basicNum` 对应的统计数字在两个配置中各维护了一次映射关系。菜单配置中维护了 `numArr`，内容配置中维护了 `modelNum`。

### 4. 过滤逻辑重复维护

海外企业和个体工商户的过滤逻辑在菜单配置和内容配置中各维护了一次。

**场景**：
- **海外企业**：内容配置侧通过 `wftCommon.is_overseas_config` 过滤；菜单配置侧通过 `isOverseasUser` 参数过滤。
- **个体工商户**：内容配置侧单独维护 `corpModuleCfgIIP`；菜单配置侧通过条件判断过滤。

### 5. 配置不一致风险

特殊企业过滤逻辑依赖菜单配置决定内容显示，存在耦合。

## 根本原因

1. **全量加载**：配置采用静态导入，初始化时全部加载。
2. **缺乏按需加载**：未根据企业类型动态加载。
3. **配置分离**：菜单和内容配置分离，缺乏统一配置源。
4. **逻辑分散**：过滤逻辑在两侧各自实现。

## 影响范围

- **性能**：首屏加载慢，内存占用高。
- **维护**：新增模块需修改多处，维护成本高。
- **一致性**：两处配置可能不同步。
- **体验**：海外企业可能看到无内容的菜单项。
